{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\LENOVO\\\\Downloads\\\\CoolGrid-app\\\\frontend\\\\src\\\\pages\\\\SupplierRequestDetails.jsx\",\n  _s = $RefreshSig$();\n// src/pages/SupplierRequestDetails.jsx\nimport React, { useEffect, useState } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport axios from \"axios\";\nimport { Container, Card, Button, Form, Alert, Spinner } from \"react-bootstrap\";\nimport io from \"socket.io-client\";\nimport { motion } from \"framer-motion\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst BACKEND = \"http://localhost:5000\";\nconst socket = io(BACKEND, {\n  autoConnect: true\n});\nexport default function SupplierRequestDetails() {\n  _s();\n  var _request$customer;\n  const {\n    requestId\n  } = useParams();\n  const [request, setRequest] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  // OTP\n  const [enteredOtp, setEnteredOtp] = useState(\"\");\n  const [verificationMsg, setVerificationMsg] = useState(\"\");\n\n  // charging states\n  const [chargingStarted, setChargingStarted] = useState(false);\n  const [chargingCompleted, setChargingCompleted] = useState(false);\n\n  // payment states\n  // paymentMode is derived from socket events OR backend request.payment.mode\n  const [paymentMode, setPaymentMode] = useState(null); // \"CASH\" | \"UPI\" | null\n  const [paymentConfirmed, setPaymentConfirmed] = useState(false); // final supplier confirmation\n  const [confirmLoading, setConfirmLoading] = useState(false);\n  const [message, setMessage] = useState(\"\");\n\n  // Fetch request and initialize UI from backend\n  useEffect(() => {\n    let mounted = true;\n    const fetchRequest = async () => {\n      try {\n        var _req$payment;\n        setLoading(true);\n        const res = await axios.get(`${BACKEND}/api/request/status/${requestId}`, {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem(\"token\")}`\n          }\n        });\n        if (!mounted) return;\n        const req = res.data.request;\n        setRequest(req);\n\n        // sync charging state from backend\n        if ((req === null || req === void 0 ? void 0 : req.status) === \"CHARGING\") {\n          setChargingStarted(true);\n          setChargingCompleted(false);\n        } else if ((req === null || req === void 0 ? void 0 : req.status) === \"COMPLETED\") {\n          setChargingStarted(true);\n          setChargingCompleted(true);\n        }\n\n        // sync payment mode from backend (if already chosen/recorded)\n        if (req !== null && req !== void 0 && (_req$payment = req.payment) !== null && _req$payment !== void 0 && _req$payment.mode) {\n          setPaymentMode(req.payment.mode === \"CASH\" ? \"CASH\" : req.payment.mode);\n        }\n\n        // if already marked PAID on backend\n        if ((req === null || req === void 0 ? void 0 : req.status) === \"PAID\" || req !== null && req !== void 0 && req.payment) {\n          setPaymentConfirmed(true);\n        }\n      } catch (err) {\n        console.error(\"‚ùå Error fetching request details:\", err);\n      } finally {\n        if (mounted) setLoading(false);\n      }\n    };\n    fetchRequest();\n\n    // join the room for this request so supplier receives events relevant to this booking\n    socket.emit(\"joinRoom\", {\n      room: requestId\n    });\n    console.log(\"üì° Supplier joined room:\", requestId);\n\n    // socket listeners\n    socket.on(\"cashPaymentChosen\", data => {\n      if (data.requestId === requestId) {\n        console.log(\"üíµ Customer selected Cash:\", data);\n        setPaymentMode(\"CASH\");\n        setMessage(\"Customer has chosen Cash on Delivery. Collect payment.\");\n      }\n    });\n    socket.on(\"upiPaymentDone\", data => {\n      if (data.requestId === requestId) {\n        console.log(\"üí≥ UPI Payment Done:\", data);\n        setPaymentMode(\"UPI\");\n        setMessage(\"Customer completed UPI payment.\");\n      }\n    });\n\n    // customer may emit when they themselves confirm payment (if that flow exists)\n    socket.on(\"paymentConfirmedByCustomer\", data => {\n      if (data.requestId === requestId) {\n        console.log(\"üü¢ Payment Confirmed By Customer:\", data);\n        setPaymentConfirmed(true);\n        setMessage(\"Payment confirmed by customer.\");\n      }\n    });\n\n    // optional: keep listening for chargingStarted/completed events (if other actors emit them)\n    socket.on(\"chargingStarted\", data => {\n      if (data.requestId === requestId) {\n        setChargingStarted(true);\n        setChargingCompleted(false);\n        setMessage(\"‚ö° Charging started.\");\n      }\n    });\n    socket.on(\"chargingCompleted\", data => {\n      if (data.requestId === requestId) {\n        setChargingStarted(true);\n        setChargingCompleted(true);\n        setMessage(\"‚úÖ Charging completed.\");\n        // also set supplier details if present\n        if (data.supplier) {\n          setRequest(prev => ({\n            ...prev,\n            supplier: data.supplier\n          }));\n        }\n      }\n    });\n    return () => {\n      mounted = false;\n      socket.off(\"cashPaymentChosen\");\n      socket.off(\"upiPaymentDone\");\n      socket.off(\"paymentConfirmedByCustomer\");\n      socket.off(\"chargingStarted\");\n      socket.off(\"chargingCompleted\");\n    };\n  }, [requestId]);\n\n  // Verify OTP handler\n  const handleVerifyOtp = async () => {\n    try {\n      if (!enteredOtp) {\n        alert(\"Please enter OTP\");\n        return;\n      }\n      // backend expects { enteredOtp } per your controller\n      const res = await axios.post(`${BACKEND}/api/request/verify-otp/${requestId}`, {\n        enteredOtp\n      }, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`\n        }\n      });\n      setVerificationMsg(\"OTP Verified Successfully!\");\n      setMessage(\"‚úÖ OTP Verified ‚Äî you can start charging.\");\n      // update local request status\n      setRequest(prev => prev ? {\n        ...prev,\n        status: \"VERIFIED\"\n      } : prev);\n    } catch (err) {\n      var _err$response, _err$response2, _err$response2$data;\n      console.error(\"OTP verify error:\", ((_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.data) || err);\n      setVerificationMsg(((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.message) || \"Invalid OTP\");\n    }\n  };\n\n  // Start charging\n  const handleStartCharging = async () => {\n    try {\n      setChargingStarted(true); // optimistic update\n      const res = await axios.post(`${BACKEND}/api/request/start-charging/${requestId}`, {}, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`\n        }\n      });\n      console.log(\"Start charging response:\", res.data);\n      setMessage(\"‚ö° Charging started.\");\n      setRequest(prev => prev ? {\n        ...prev,\n        status: \"CHARGING\"\n      } : prev);\n    } catch (err) {\n      console.error(\"Error starting charging:\", err);\n      // revert optimistic\n      setChargingStarted(false);\n      alert(\"Failed to start charging. See console for details.\");\n    }\n  };\n\n  // Complete charging\n  const handleCompleteCharging = async () => {\n    try {\n      const res = await axios.post(`${BACKEND}/api/request/complete-charging/${requestId}`, {}, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`\n        }\n      });\n      console.log(\"Complete charging response:\", res.data);\n      setChargingCompleted(true);\n      setMessage(\"‚úÖ Charging completed. Awaiting payment.\");\n      setRequest(prev => prev ? {\n        ...prev,\n        status: \"COMPLETED\"\n      } : prev);\n\n      // forward supplier -> customer notification is handled by backend (controller emits chargingCompleted)\n    } catch (err) {\n      console.error(\"Error completing charging:\", err);\n      alert(\"Failed to complete charging. See console for details.\");\n    }\n  };\n\n  // Supplier confirms COD payment: call backend markPaid and emit to customer\n  const handleSupplierConfirmPayment = async () => {\n    try {\n      setConfirmLoading(true);\n      const res = await axios.post(`http://localhost:5000/api/request/payment/${requestId}`, {\n        mode: \"CASH\",\n        amountPaid: totalCost,\n        transactionId: \"COD-\" + Date.now()\n      });\n\n      // emit to customer\n      socket.emit(\"paymentConfirmedBySupplier\", {\n        customerId: request.customer._id,\n        supplierId: request.supplier._id,\n        requestId,\n        message: \"Payment Completed!\"\n      });\n\n      // update UI\n      setPaymentConfirmed(true);\n\n      // redirect supplier\n      navigate(\"/supplier/dashboard\");\n    } catch (err) {\n      console.error(\"Error confirming payment:\", err);\n    } finally {\n      setConfirmLoading(false);\n    }\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(Container, {\n      className: \"text-center mt-5\",\n      children: [/*#__PURE__*/_jsxDEV(Spinner, {\n        animation: \"border\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Loading request details...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 7\n    }, this);\n  }\n  if (!request) {\n    return /*#__PURE__*/_jsxDEV(Container, {\n      className: \"mt-5 text-center\",\n      children: /*#__PURE__*/_jsxDEV(Alert, {\n        variant: \"danger\",\n        children: \"Request not found.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(Container, {\n    className: \"mt-5\",\n    children: /*#__PURE__*/_jsxDEV(Card, {\n      className: \"p-4 shadow\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"\\uD83D\\uDD0C Request Details\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [/*#__PURE__*/_jsxDEV(\"b\", {\n          children: \"Customer:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 260,\n          columnNumber: 11\n        }, this), \" \", request.customerName || ((_request$customer = request.customer) === null || _request$customer === void 0 ? void 0 : _request$customer.name)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 259,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [/*#__PURE__*/_jsxDEV(\"b\", {\n          children: \"Units Needed:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 11\n        }, this), \" \", request.unitsRequested]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 262,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [/*#__PURE__*/_jsxDEV(\"b\", {\n          children: \"Status:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 11\n        }, this), \" \", request.status]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 269,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"\\uD83D\\uDD10 OTP Verification\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 271,\n        columnNumber: 9\n      }, this), verificationMsg && /*#__PURE__*/_jsxDEV(Alert, {\n        variant: \"info\",\n        children: verificationMsg\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 273,\n        columnNumber: 29\n      }, this), request.status !== \"COMPLETED\" && !paymentMode && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(Form.Group, {\n          children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n            children: \"Enter OTP sent to customer\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 278,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n            type: \"text\",\n            placeholder: \"Enter OTP\",\n            value: enteredOtp,\n            onChange: e => setEnteredOtp(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 279,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 277,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          className: \"mt-3\",\n          variant: \"primary\",\n          onClick: handleVerifyOtp,\n          children: \"Verify OTP\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 287,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 293,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"Charging Controls\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 297,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(motion.div, {\n          whileTap: {\n            scale: 0.95\n          },\n          initial: {\n            opacity: 0,\n            y: 20\n          },\n          animate: {\n            opacity: 1,\n            y: 0\n          },\n          transition: {\n            duration: 0.3\n          },\n          className: \"mb-3\",\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"success\",\n            onClick: handleStartCharging,\n            disabled: chargingStarted,\n            style: {\n              width: \"200px\"\n            },\n            children: chargingStarted ? \"Charging Started ‚úî\" : \"Start Charging\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 306,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 299,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(motion.div, {\n          whileTap: {\n            scale: 0.95\n          },\n          initial: {\n            opacity: 0,\n            y: 20\n          },\n          animate: {\n            opacity: 1,\n            y: 0\n          },\n          transition: {\n            duration: 0.3,\n            delay: 0.2\n          },\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"primary\",\n            onClick: handleCompleteCharging,\n            disabled: !chargingStarted || chargingCompleted,\n            style: {\n              width: \"200px\"\n            },\n            children: chargingCompleted ? \"Charging Completed ‚úî\" : \"Complete Charging\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 322,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 316,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mt-4\",\n          children: chargingCompleted ? /*#__PURE__*/_jsxDEV(Alert, {\n            variant: \"success\",\n            children: \"Charging fully completed!\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 334,\n            columnNumber: 15\n          }, this) : chargingStarted ? /*#__PURE__*/_jsxDEV(Alert, {\n            variant: \"info\",\n            children: \"Charging in progress...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 336,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(Alert, {\n            variant: \"warning\",\n            children: \"Waiting to start charging...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 338,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 332,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 296,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 343,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"\\uD83D\\uDCB3 Payment\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 350,\n        columnNumber: 1\n      }, this), paymentMode === \"CASH\" && chargingCompleted && !paymentConfirmed && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-4\",\n        children: /*#__PURE__*/_jsxDEV(motion.div, {\n          whileTap: {\n            scale: 0.95\n          },\n          initial: {\n            opacity: 0,\n            y: 20\n          },\n          animate: {\n            opacity: 1,\n            y: 0\n          },\n          transition: {\n            duration: 0.3\n          },\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"success\",\n            onClick: handleSupplierConfirmPayment,\n            disabled: confirmLoading,\n            style: {\n              width: \"220px\"\n            },\n            children: confirmLoading ? \"Confirming...\" : \"Confirm Payment (COD)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 361,\n            columnNumber: 7\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 355,\n          columnNumber: 5\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 354,\n        columnNumber: 3\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 255,\n    columnNumber: 5\n  }, this);\n}\n_s(SupplierRequestDetails, \"6g0NNIA9YI/nJ18MUlA8utgss34=\", false, function () {\n  return [useParams];\n});\n_c = SupplierRequestDetails;\nvar _c;\n$RefreshReg$(_c, \"SupplierRequestDetails\");","map":{"version":3,"names":["React","useEffect","useState","useParams","axios","Container","Card","Button","Form","Alert","Spinner","io","motion","jsxDEV","_jsxDEV","Fragment","_Fragment","BACKEND","socket","autoConnect","SupplierRequestDetails","_s","_request$customer","requestId","request","setRequest","loading","setLoading","enteredOtp","setEnteredOtp","verificationMsg","setVerificationMsg","chargingStarted","setChargingStarted","chargingCompleted","setChargingCompleted","paymentMode","setPaymentMode","paymentConfirmed","setPaymentConfirmed","confirmLoading","setConfirmLoading","message","setMessage","mounted","fetchRequest","_req$payment","res","get","headers","Authorization","localStorage","getItem","req","data","status","payment","mode","err","console","error","emit","room","log","on","supplier","prev","off","handleVerifyOtp","alert","post","_err$response","_err$response2","_err$response2$data","response","handleStartCharging","handleCompleteCharging","handleSupplierConfirmPayment","amountPaid","totalCost","transactionId","Date","now","customerId","customer","_id","supplierId","navigate","className","children","animation","fileName","_jsxFileName","lineNumber","columnNumber","variant","customerName","name","unitsRequested","Group","Label","Control","type","placeholder","value","onChange","e","target","onClick","div","whileTap","scale","initial","opacity","y","animate","transition","duration","disabled","style","width","delay","_c","$RefreshReg$"],"sources":["C:/Users/LENOVO/Downloads/CoolGrid-app/frontend/src/pages/SupplierRequestDetails.jsx"],"sourcesContent":["// src/pages/SupplierRequestDetails.jsx\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\nimport { Container, Card, Button, Form, Alert, Spinner } from \"react-bootstrap\";\r\nimport io from \"socket.io-client\";\r\nimport { motion } from \"framer-motion\";\r\n\r\nconst BACKEND = \"http://localhost:5000\";\r\nconst socket = io(BACKEND, { autoConnect: true });\r\n\r\nexport default function SupplierRequestDetails() {\r\n  const { requestId } = useParams();\r\n\r\n  const [request, setRequest] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  // OTP\r\n  const [enteredOtp, setEnteredOtp] = useState(\"\");\r\n  const [verificationMsg, setVerificationMsg] = useState(\"\");\r\n\r\n  // charging states\r\n  const [chargingStarted, setChargingStarted] = useState(false);\r\n  const [chargingCompleted, setChargingCompleted] = useState(false);\r\n\r\n  // payment states\r\n  // paymentMode is derived from socket events OR backend request.payment.mode\r\n  const [paymentMode, setPaymentMode] = useState(null); // \"CASH\" | \"UPI\" | null\r\n  const [paymentConfirmed, setPaymentConfirmed] = useState(false); // final supplier confirmation\r\n  const [confirmLoading, setConfirmLoading] = useState(false);\r\n\r\n  const [message, setMessage] = useState(\"\");\r\n\r\n  // Fetch request and initialize UI from backend\r\n  useEffect(() => {\r\n    let mounted = true;\r\n\r\n    const fetchRequest = async () => {\r\n      try {\r\n        setLoading(true);\r\n        const res = await axios.get(`${BACKEND}/api/request/status/${requestId}`, {\r\n          headers: { Authorization: `Bearer ${localStorage.getItem(\"token\")}` },\r\n        });\r\n\r\n        if (!mounted) return;\r\n        const req = res.data.request;\r\n        setRequest(req);\r\n\r\n        // sync charging state from backend\r\n        if (req?.status === \"CHARGING\") {\r\n          setChargingStarted(true);\r\n          setChargingCompleted(false);\r\n        } else if (req?.status === \"COMPLETED\") {\r\n          setChargingStarted(true);\r\n          setChargingCompleted(true);\r\n        }\r\n\r\n        // sync payment mode from backend (if already chosen/recorded)\r\n        if (req?.payment?.mode) {\r\n          setPaymentMode(req.payment.mode === \"CASH\" ? \"CASH\" : req.payment.mode);\r\n        }\r\n\r\n        // if already marked PAID on backend\r\n        if (req?.status === \"PAID\" || req?.payment) {\r\n          setPaymentConfirmed(true);\r\n        }\r\n      } catch (err) {\r\n        console.error(\"‚ùå Error fetching request details:\", err);\r\n      } finally {\r\n        if (mounted) setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchRequest();\r\n\r\n    // join the room for this request so supplier receives events relevant to this booking\r\n    socket.emit(\"joinRoom\", { room: requestId });\r\n    console.log(\"üì° Supplier joined room:\", requestId);\r\n\r\n    // socket listeners\r\n    socket.on(\"cashPaymentChosen\", (data) => {\r\n      if (data.requestId === requestId) {\r\n        console.log(\"üíµ Customer selected Cash:\", data);\r\n        setPaymentMode(\"CASH\");\r\n        setMessage(\"Customer has chosen Cash on Delivery. Collect payment.\");\r\n      }\r\n    });\r\n\r\n    socket.on(\"upiPaymentDone\", (data) => {\r\n      if (data.requestId === requestId) {\r\n        console.log(\"üí≥ UPI Payment Done:\", data);\r\n        setPaymentMode(\"UPI\");\r\n        setMessage(\"Customer completed UPI payment.\");\r\n      }\r\n    });\r\n\r\n    // customer may emit when they themselves confirm payment (if that flow exists)\r\n    socket.on(\"paymentConfirmedByCustomer\", (data) => {\r\n      if (data.requestId === requestId) {\r\n        console.log(\"üü¢ Payment Confirmed By Customer:\", data);\r\n        setPaymentConfirmed(true);\r\n        setMessage(\"Payment confirmed by customer.\");\r\n      }\r\n    });\r\n\r\n    // optional: keep listening for chargingStarted/completed events (if other actors emit them)\r\n    socket.on(\"chargingStarted\", (data) => {\r\n      if (data.requestId === requestId) {\r\n        setChargingStarted(true);\r\n        setChargingCompleted(false);\r\n        setMessage(\"‚ö° Charging started.\");\r\n      }\r\n    });\r\n\r\n    socket.on(\"chargingCompleted\", (data) => {\r\n      if (data.requestId === requestId) {\r\n        setChargingStarted(true);\r\n        setChargingCompleted(true);\r\n        setMessage(\"‚úÖ Charging completed.\");\r\n        // also set supplier details if present\r\n        if (data.supplier) {\r\n          setRequest((prev) => ({ ...prev, supplier: data.supplier }));\r\n        }\r\n      }\r\n    });\r\n\r\n    return () => {\r\n      mounted = false;\r\n      socket.off(\"cashPaymentChosen\");\r\n      socket.off(\"upiPaymentDone\");\r\n      socket.off(\"paymentConfirmedByCustomer\");\r\n      socket.off(\"chargingStarted\");\r\n      socket.off(\"chargingCompleted\");\r\n    };\r\n  }, [requestId]);\r\n\r\n  // Verify OTP handler\r\n  const handleVerifyOtp = async () => {\r\n    try {\r\n      if (!enteredOtp) {\r\n        alert(\"Please enter OTP\");\r\n        return;\r\n      }\r\n      // backend expects { enteredOtp } per your controller\r\n      const res = await axios.post(\r\n        `${BACKEND}/api/request/verify-otp/${requestId}`,\r\n        { enteredOtp },\r\n        { headers: { Authorization: `Bearer ${localStorage.getItem(\"token\")}` } }\r\n      );\r\n\r\n      setVerificationMsg(\"OTP Verified Successfully!\");\r\n      setMessage(\"‚úÖ OTP Verified ‚Äî you can start charging.\");\r\n      // update local request status\r\n      setRequest((prev) => (prev ? { ...prev, status: \"VERIFIED\" } : prev));\r\n    } catch (err) {\r\n      console.error(\"OTP verify error:\", err.response?.data || err);\r\n      setVerificationMsg(err.response?.data?.message || \"Invalid OTP\");\r\n    }\r\n  };\r\n\r\n  // Start charging\r\n  const handleStartCharging = async () => {\r\n    try {\r\n      setChargingStarted(true); // optimistic update\r\n      const res = await axios.post(\r\n        `${BACKEND}/api/request/start-charging/${requestId}`,\r\n        {},\r\n        { headers: { Authorization: `Bearer ${localStorage.getItem(\"token\")}` } }\r\n      );\r\n      console.log(\"Start charging response:\", res.data);\r\n      setMessage(\"‚ö° Charging started.\");\r\n      setRequest((prev) => (prev ? { ...prev, status: \"CHARGING\" } : prev));\r\n    } catch (err) {\r\n      console.error(\"Error starting charging:\", err);\r\n      // revert optimistic\r\n      setChargingStarted(false);\r\n      alert(\"Failed to start charging. See console for details.\");\r\n    }\r\n  };\r\n\r\n  // Complete charging\r\n  const handleCompleteCharging = async () => {\r\n    try {\r\n      const res = await axios.post(\r\n        `${BACKEND}/api/request/complete-charging/${requestId}`,\r\n        {},\r\n        { headers: { Authorization: `Bearer ${localStorage.getItem(\"token\")}` } }\r\n      );\r\n\r\n      console.log(\"Complete charging response:\", res.data);\r\n      setChargingCompleted(true);\r\n      setMessage(\"‚úÖ Charging completed. Awaiting payment.\");\r\n      setRequest((prev) => (prev ? { ...prev, status: \"COMPLETED\" } : prev));\r\n\r\n      // forward supplier -> customer notification is handled by backend (controller emits chargingCompleted)\r\n    } catch (err) {\r\n      console.error(\"Error completing charging:\", err);\r\n      alert(\"Failed to complete charging. See console for details.\");\r\n    }\r\n  };\r\n\r\n  // Supplier confirms COD payment: call backend markPaid and emit to customer\r\n const handleSupplierConfirmPayment = async () => {\r\n  try {\r\n    setConfirmLoading(true);\r\n\r\n    const res = await axios.post(\r\n      `http://localhost:5000/api/request/payment/${requestId}`,\r\n      {\r\n        mode: \"CASH\",\r\n        amountPaid: totalCost,\r\n        transactionId: \"COD-\" + Date.now(),\r\n      }\r\n    );\r\n\r\n    // emit to customer\r\n    socket.emit(\"paymentConfirmedBySupplier\", {\r\n      customerId: request.customer._id,\r\n      supplierId: request.supplier._id,\r\n      requestId,\r\n      message: \"Payment Completed!\",\r\n    });\r\n\r\n    // update UI\r\n    setPaymentConfirmed(true);\r\n\r\n    // redirect supplier\r\n    navigate(\"/supplier/dashboard\");\r\n  } catch (err) {\r\n    console.error(\"Error confirming payment:\", err);\r\n  } finally {\r\n    setConfirmLoading(false);\r\n  }\r\n};\r\n\r\n\r\n  if (loading) {\r\n    return (\r\n      <Container className=\"text-center mt-5\">\r\n        <Spinner animation=\"border\" />\r\n        <p>Loading request details...</p>\r\n      </Container>\r\n    );\r\n  }\r\n\r\n  if (!request) {\r\n    return (\r\n      <Container className=\"mt-5 text-center\">\r\n        <Alert variant=\"danger\">Request not found.</Alert>\r\n      </Container>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Container className=\"mt-5\">\r\n      <Card className=\"p-4 shadow\">\r\n        <h3>üîå Request Details</h3>\r\n\r\n        <p>\r\n          <b>Customer:</b> {request.customerName || request.customer?.name}\r\n        </p>\r\n        <p>\r\n          <b>Units Needed:</b> {request.unitsRequested}\r\n        </p>\r\n        <p>\r\n          <b>Status:</b> {request.status}\r\n        </p>\r\n\r\n        <hr />\r\n\r\n        <h4>üîê OTP Verification</h4>\r\n\r\n        {verificationMsg && <Alert variant=\"info\">{verificationMsg}</Alert>}\r\n\r\n        {request.status !== \"COMPLETED\" && !paymentMode && (\r\n          <>\r\n            <Form.Group>\r\n              <Form.Label>Enter OTP sent to customer</Form.Label>\r\n              <Form.Control\r\n                type=\"text\"\r\n                placeholder=\"Enter OTP\"\r\n                value={enteredOtp}\r\n                onChange={(e) => setEnteredOtp(e.target.value)}\r\n              />\r\n            </Form.Group>\r\n\r\n            <Button className=\"mt-3\" variant=\"primary\" onClick={handleVerifyOtp}>\r\n              Verify OTP\r\n            </Button>\r\n          </>\r\n        )}\r\n\r\n        <hr />\r\n\r\n        {/* Charging Controls */}\r\n        <div className=\"p-4\">\r\n          <h3>Charging Controls</h3>\r\n\r\n          <motion.div\r\n            whileTap={{ scale: 0.95 }}\r\n            initial={{ opacity: 0, y: 20 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            transition={{ duration: 0.3 }}\r\n            className=\"mb-3\"\r\n          >\r\n            <Button\r\n              variant=\"success\"\r\n              onClick={handleStartCharging}\r\n              disabled={chargingStarted}\r\n              style={{ width: \"200px\" }}\r\n            >\r\n              {chargingStarted ? \"Charging Started ‚úî\" : \"Start Charging\"}\r\n            </Button>\r\n          </motion.div>\r\n\r\n          <motion.div\r\n            whileTap={{ scale: 0.95 }}\r\n            initial={{ opacity: 0, y: 20 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            transition={{ duration: 0.3, delay: 0.2 }}\r\n          >\r\n            <Button\r\n              variant=\"primary\"\r\n              onClick={handleCompleteCharging}\r\n              disabled={!chargingStarted || chargingCompleted}\r\n              style={{ width: \"200px\" }}\r\n            >\r\n              {chargingCompleted ? \"Charging Completed ‚úî\" : \"Complete Charging\"}\r\n            </Button>\r\n          </motion.div>\r\n\r\n          <div className=\"mt-4\">\r\n            {chargingCompleted ? (\r\n              <Alert variant=\"success\">Charging fully completed!</Alert>\r\n            ) : chargingStarted ? (\r\n              <Alert variant=\"info\">Charging in progress...</Alert>\r\n            ) : (\r\n              <Alert variant=\"warning\">Waiting to start charging...</Alert>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        <hr />\r\n\r\n         {/* *********************************************************************\r\n              UPDATED PAYMENT SECTION (MATCHES UI STYLE OF CHARGING CONTROLS)\r\n        ********************************************************************** */}\r\n\r\n       {/* Payment Section */}\r\n<h4>üí≥ Payment</h4>\r\n\r\n{/* Show Confirm Payment button for COD when charging completed */}\r\n{paymentMode === \"CASH\" && chargingCompleted && !paymentConfirmed && (\r\n  <div className=\"p-4\">\r\n    <motion.div\r\n      whileTap={{ scale: 0.95 }}\r\n      initial={{ opacity: 0, y: 20 }}\r\n      animate={{ opacity: 1, y: 0 }}\r\n      transition={{ duration: 0.3 }}\r\n    >\r\n      <Button\r\n        variant=\"success\"\r\n        onClick={handleSupplierConfirmPayment}\r\n        disabled={confirmLoading}\r\n        style={{ width: \"220px\" }}\r\n      >\r\n        {confirmLoading ? \"Confirming...\" : \"Confirm Payment (COD)\"}\r\n      </Button>\r\n    </motion.div>\r\n  </div>\r\n)}\r\n\r\n      </Card>\r\n    </Container>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}